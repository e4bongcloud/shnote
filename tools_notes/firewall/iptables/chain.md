# Chain

iptables에서 chain은 네트워크 패킷이 전달되는 경로를 지정하는 개념입니다.  
chain은 여러 개의 rule이 연결된 것으로, 각 rule은 패킷을 처리할 수 있는 액션을 지정합니다.  
따라서, chain은 rule을 적용하는 경로를 결정하는 중요한 요소입니다.

iptables는 세 개의 기본 체인(INPUT, FORWARD, OUTPUT)과 사용자 정의 체인을 포함한 여러 개의 체인을 가지고 있습니다. 각 체인은 다음과 같은 역할을 수행합니다.

# chain

| chain   | 설명|
| ------- | --- |
| INPUT   | 방화벽을 최종 목적지로 하는 체인 <br> 서버로 들어오는 기본 정책 |
| OUTPUT  | 방화벽을 최초 출발지로 하는 체인 <br> 서버에서 나가는 기본 정책|
| FORWARD | 방화벽을 통과하는 채널을 의미하는 것으로 방화벽을 별도의 서버로 구성해서 서비스할떄 사용하는 체인 <br> LAN에서 패킷이 전송될 위치를 제어합니다.|

# 그외 특수체인으로 FORWARD의 이전, 이후의 체인도 있습니다. 

| chain   | 설명|
| ------- | --- |
| PREROUTING | 패킷이 라우터의 인터페이스로 들어오고 NAT(Network Address Translation) 처리되기 전에 가로채는 체인입니다. PREROUTING 체인은 패킷의 도착지 주소를 변경하거나 포트 포워딩 등을 구현할 때 사용됩니다. |
| POSTROUTING | 패킷이 NAT 처리된 후, 라우터의 인터페이스를 통해 나가기 전에 가로채는 체인입니다. POSTROUTING 체인은 패킷의 출발지 주소를 변경하거나 스니핑, 마스커레이드, 로깅 등을 구현할 때 사용됩니다. |

이러한 체인들은 iptables의 nat 테이블에서 주로 사용되며, PREROUTING 체인에서는 DNAT 등의 액션을 사용하여 패킷의 도착지 주소나 포트를 변경하고, POSTROUTING 체인에서는 SNAT 등의 액션을 사용하여 패킷의 출발지 주소나 포트를 변경할 수 있습니다.

