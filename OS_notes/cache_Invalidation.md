# cache_Invalidation
캐시는 CPU나 메모리와 같은 속도가 빠른 장치와 HDD/SSD와 같은 속도가 상대적으로 느린 장치 간의 속도 차이를 줄이기 위해 사용됩니다. 하지만 캐시에 데이터를 저장함으로써 consistency(일관성) 문제가 발생할 수 있습니다.

예를 들어, HDD/SSD에 저장된 데이터를 수정하면, 캐시에는 해당 데이터의 이전 버전이 남아있을 수 있습니다. 이 경우, 캐시에 남아있는 데이터를 사용하면 consistency 문제가 발생하게 됩니다.

이러한 문제를 해결하기 위해, 캐시의 값을 갱신해주는 과정이 필요합니다. 이를 cache invalidation(캐시 무효화)라고 합니다. Cache invalidation은 크게 두 가지 방법으로 구현됩니다.

## Write-through cache(동시기록 캐시)
Write-through cache는 데이터를 캐시에 저장하는 동시에 메인 메모리와 같은 다른 저장 장치에도 동시에 데이터를 기록합니다. 따라서 캐시와 저장 장치 간의 데이터 일관성을 유지하기 위해 별도의 작업이 필요하지 않습니다.

하지만, 메모리와 같은 다른 저장 장치에 데이터를 쓰는 작업 때문에 쓰기 연산이 느릴 수 있습니다.

## Write-back cache
Write-back cache는 데이터를 캐시에만 저장하고, 메인 메모리와 같은 다른 저장 장치에는 일정 시간이나 특정 조건을 충족시킬 때까지 데이터를 기록하지 않습니다. 이를 따로 기록해주는 작업이 필요합니다.

이 방식은 쓰기 연산을 빠르게 수행할 수 있으며, 메모리와 같은 다른 저장 장치에 데이터를 기록하는 작업 때문에 발생하는 오버헤드가 없습니다. 하지만, 캐시와 저장 장치 간의 데이터 일관성을 유지하기 위해서는 별도의 작업이 필요합니다.

## Write-around cache(No-write allocate 또는 write-no-allocate)
Write-around cache는 데이터를 직접 메인 메모리나 다른 저장 장치에 기록하며, 캐시는 읽기 연산에서만 사용됩니다. 따라서 쓰기 연산이 빈번하지 않은 경우, 이 방식이 유용합니다.

하지만, 이러한 캐시 정책은 `trade-off`가 존재합니다.  
`Write-through cache`는 consistency를 유지하기 위해 디스크에 쓰는 횟수가 늘어나기 때문에 write 속도가 느리지만, 데이터 손실 가능성이 적습니다. 반면에 write-back cache는 캐시에만 값을 쓰기 때문에 write 속도가 빠르지만, 서버에 문제가 생겼을 때 데이터 손실 가능성이 높습니다. Write-around cache는 write가 많지만 read가 적은 경우에 적합합니다.

따라서, 어떤 캐시 정책을 선택할지는 사용자의 요구사항과 시스템 환경에 따라 다릅니다. 이를 고려하여 최적의 캐시 정책을 선택하는 것이 중요합니다. 또한, 캐시 무효화도 적절히 수행해야 합니다. 캐시의 값이 유효하지 않으면 데이터 불일치 문제가 발생할 수 있기 때문입니다.
